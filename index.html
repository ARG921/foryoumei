<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Locket For U</title>
  <style>
    :root{--bg:#fff6fb;--accent-2:#ffd9ec;--text:#5b4b56;--shadow:0 10px 30px rgba(0,0,0,.15)}
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
      background:var(--bg);
      color:var(--text);
      display:grid;place-items:center;
      overflow:hidden;
    }
    .falling{position:fixed;top:-10px;width:20px;height:20px;background:var(--accent-2);border-radius:50%;opacity:0.8;animation:fall linear forwards}
    @keyframes fall{to{transform:translateY(110vh) rotate(360deg);opacity:0}}
    .wrap{width:min(92vw,860px);text-align:center;padding:20px 16px 40px;position:relative;z-index:2}
    h1{font-size:clamp(22px,4vw,34px);margin:6px 0 18px}
    .stage{display:grid;place-items:center}
    .locket{width:min(90vw,520px);height:min(90vw,260px);position:relative;cursor:pointer}
    .half{position:absolute;top:0;height:100%;width:50%;transition:transform .7s cubic-bezier(.2,.7,.1,1);will-change:transform}
    .left{left:0;transform-origin:100% 50%;z-index:2}
    .right{right:0;transform-origin:0% 50%;z-index:1}
    .shell{position:absolute;inset:0;border-radius:50%/50%;background:radial-gradient(120% 120% at 30% 20%,#fff8d6,#e2bb4a 60%,#cfa63a 100%);border:4px solid #f7e3a0;box-shadow:var(--shadow)}
    .window{position:absolute;inset:12%;border-radius:50%/50%;background:#fff;display:grid;place-items:center;overflow:hidden;backface-visibility:hidden;opacity:0;transition:opacity .35s ease}
    .window img{width:100%;height:100%;object-fit:cover}
    .locket:not(.open) .left{transform:translateX(50%) rotateY(0)}
    .locket:not(.open) .right{transform:translateX(-50%) rotateY(0)}
    .locket:not(.open) .window{opacity:0}
    .locket.open .left{transform:translateX(0) rotateY(0)}
    .locket.open .right{transform:translateX(0) rotateY(0)}
    .locket.open .window{opacity:1}
    .message{margin-top:16px;opacity:0;transform:translateY(6px);transition:opacity .35s ease,transform .35s ease}
    .message.show{opacity:1;transform:translateY(0)}
    @media (max-width:480px){.locket{width:88vw;height:44vw}}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>✨ Liontin Untukmu ✨</h1>
    <div class="stage">
      <div id="locket" class="locket" role="button" aria-label="Buka atau tutup liontin" tabindex="0">
        <div class="half left" aria-hidden="true">
          <div class="shell"></div>
          <div class="window"><img src="foto1.jpg" alt="Foto kiri" /></div>
        </div>
        <div class="half right" aria-hidden="true">
          <div class="shell"></div>
          <div class="window"><img src="foto2.jpg" alt="Foto kanan" /></div>
        </div>
      </div>
      <p id="msg" class="message">Mei… i can feel the space between us growing, and though it stings a little, i understand. Sometimes life pulls us in different directions, and we need that distance to breathe. Just know that no matter how far it feels, i still wish you warmth, peace, and light in every step you take.</p>
      <audio id="music" src="liontin.mp3" preload="auto" loop></audio>
    </div>
  </div>
  <script>
    (function(){
      const locket = document.getElementById('locket');
      const music  = document.getElementById('music');
      const msg    = document.getElementById('msg');
      let isOpen   = false;
      let pausedTime = 0;
      if (music) music.volume = 0.4;

      function openLocket(){
        isOpen = true;
        locket.classList.add('open');
        msg.classList.add('show');
        if (music) {
          if (pausedTime > 0) {
            if (music.readyState >= 1) {
              music.currentTime = pausedTime;
            } else {
              const onMeta = () => { music.currentTime = pausedTime; music.removeEventListener('loadedmetadata', onMeta); };
              music.addEventListener('loadedmetadata', onMeta);
            }
          }
          const p = music.play();
          if (p && typeof p.catch === 'function') p.catch(()=>{});
        }
      }

      function closeLocket(){
        isOpen = false;
        locket.classList.remove('open');
        msg.classList.remove('show');
        if (music) {
          pausedTime = music.currentTime;
          music.pause();
        }
      }

      function toggle(){ isOpen ? closeLocket() : openLocket(); }

      locket.addEventListener('click', toggle);
      locket.addEventListener('keydown', e => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); toggle(); } });

      function createFalling(){
        const el = document.createElement('div');
        el.className = 'falling';
        el.style.left = Math.random()*100 + 'vw';
        el.style.animationDuration = (3+Math.random()*2)+'s';
        document.body.appendChild(el);
        setTimeout(()=>el.remove(),5000);
      }
      setInterval(createFalling,300);

      setTimeout(() => {
        const before = locket.classList.contains('open');
        locket.dispatchEvent(new Event('click'));
        const after = locket.classList.contains('open');
        console.assert(before !== after, 'Toggle should change open state');
        locket.dispatchEvent(new Event('click'));
        console.assert(locket.classList.contains('open') === before, 'Toggle back should restore state');
      }, 0);
    })();
  </script>
</body>
</html>

